<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Comissão e Pacotes</title>
    <style>
        /* Seu estilo CSS permanece o mesmo */
        body {
            background-image: url('https://r4.wallpaperflare.com/wallpaper/671/31/673/tv-show-star-vs-the-forces-of-evil-star-butterfly-wallpaper-a920088dc10a7dfbd63728bff031867d.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
            font-family: 'Comic Sans MS', 'Comic Sans', cursive;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .panel {
            width: 22%;
            padding: 20px;
            border: 2px solid #FF6EC7;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            margin: 20px;
            display: inline-block;
            vertical-align: top;
            background-color: rgba(255, 255, 255, 0.9);
            position: relative;
        }
        h2 {
            font-size: 1.5em;
            margin-bottom: 10px;
            text-align: center;
            color: #FF6EC7;
        }
        .sol-button {
            background-color: #FF6EC7;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            color: white;
            cursor: pointer;
        }
        button {
            display: block;
            margin: 10px 0;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            background-color: #FFD700;
            color: white;
            cursor: pointer;
        }
        .log-item {
            display: flex;
            align-items: center;
            margin-top: 10px;
            font-size: 0.9em;
            color: #333;
        }
        .log-item button {
            margin-left: 10px;
            background-color: #FF6EC7;
            cursor: pointer;
        }
        .log-item::before {
            content: "⭐";
            margin-right: 5px;
        }
        input[type="text"], input[type="number"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin: 5px 0;
            border: 2px solid #FF6EC7;
            border-radius: 5px;
        }
        label {
            font-weight: bold;
            margin-top: 10px;
            display: block;
            color: #FF6EC7;
        }
        p, ul {
            margin: 10px 0;
            padding: 0;
        }
        ul {
            list-style-type: none;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <script>
        // Configurações do Firebase
        var firebaseConfig = {
            apiKey: "SUA_API_KEY",
            authDomain: "SEU_PROJETO.firebaseapp.com",
            databaseURL: "https://SEU_PROJETO.firebaseio.com",
            projectId: "SEU_PROJETO",
            storageBucket: "SEU_PROJETO.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };
        // Inicializa o Firebase
        firebase.initializeApp(firebaseConfig);
    </script>
</head>
<body>
    <!-- Seus painéis e estrutura HTML permanecem os mesmos -->
    <!-- Código HTML omitido para brevidade -->

    <script>
        let db = firebase.database();

        let totalComissaoSombra = 0;
        let totalComissaoSol = 0;
        let totalLogsSombra = 0;
        let totalLogsSol = 0;
        let logsSombra = {};
        let logsSol = {};
        let exchangeRate = 5.53;
        let goldRateR = 31.00;
        let goldRateD = 5.55;
        let totalLucro = 0;
        let pacoteQuantidades = {
            10: 0,
            30: 0,
            50: 0,
            100: 0
        };

        const pacotePrecos = {
            10: 7.30,
            30: 21.00,
            50: 35.00,
            100: 70.00
        };
        const pacoteLucro = {
            10: 1.00,
            30: 2.00,
            50: 3.50,
            100: 5.00
        };

        let registrosCow = [];
        let registrosLBW = [];
        let registrosDW = [];

        let listaOuroGlobal = [];

        let totalLucroCow = 0;
        let totalLucroLBW = 0;
        let totalLucroDW = 0;

        function saveState() {
            const state = {
                totalComissaoSombra,
                totalComissaoSol,
                totalLogsSombra,
                totalLogsSol,
                logsSombra,
                logsSol,
                exchangeRate,
                goldRateR,
                goldRateD,
                totalLucro,
                pacoteQuantidades,
                quantidadeOuro: document.getElementById('quantidadeOuro').value,
                registrosCow,
                registrosLBW,
                registrosDW,
                totalLucroCow,
                totalLucroLBW,
                totalLucroDW
            };
            db.ref('appState').set(state);
        }

        function loadState() {
            db.ref('appState').on('value', (snapshot) => {
                const state = snapshot.val();
                if (state) {
                    totalComissaoSombra = state.totalComissaoSombra;
                    totalComissaoSol = state.totalComissaoSol;
                    totalLogsSombra = state.totalLogsSombra;
                    totalLogsSol = state.totalLogsSol;
                    logsSombra = state.logsSombra;
                    logsSol = state.logsSol;
                    exchangeRate = state.exchangeRate;
                    goldRateR = state.goldRateR;
                    goldRateD = state.goldRateD;
                    totalLucro = state.totalLucro;
                    pacoteQuantidades = state.pacoteQuantidades;
                    document.getElementById('quantidadeOuro').value = state.quantidadeOuro;
                    document.getElementById('exchangeRate').value = exchangeRate;
                    document.getElementById('goldRateR').value = goldRateR;
                    document.getElementById('goldRateD').value = goldRateD;
                    registrosCow = state.registrosCow || [];
                    registrosLBW = state.registrosLBW || [];
                    registrosDW = state.registrosDW || [];
                    totalLucroCow = state.totalLucroCow || 0;
                    totalLucroLBW = state.totalLucroLBW || 0;
                    totalLucroDW = state.totalLucroDW || 0;
                    updateDisplays();
                }
            });
        }

        function updateDisplays() {
            document.getElementById('totalComissaoSombra').innerText = totalComissaoSombra.toFixed(2);
            document.getElementById('totalLogsSombra').innerText = totalLogsSombra.toFixed(2);
            document.getElementById('totalComissaoSol').innerText = totalComissaoSol.toFixed(2);
            document.getElementById('totalLogsSol').innerText = totalLogsSol.toFixed(2);
            document.getElementById('logsSombra').innerHTML = Object.keys(logsSombra).map(cliente => 
                `<li class="log-item" id="log-sombra-${cliente}">
                    ${logsSombra[cliente].verified ? '✔️ ' : ''}${cliente}: ${logsSombra[cliente].values.join(', ')} (Total: ${logsSombra[cliente].total.toFixed(2)}, ${logsSombra[cliente].time})
                    <button onclick="verifyLog('sombra', '${cliente}')">✔️</button>
                    <button onclick="deleteLog('sombra', '${cliente}')">❌</button>
                </li>`
            ).join('');
            document.getElementById('logsSol').innerHTML = Object.keys(logsSol).map(cliente => 
                `<li class="log-item" id="log-sol-${cliente}">
                    ${logsSol[cliente].verified ? '✔️ ' : ''}${cliente}: ${logsSol[cliente].values.join(', ')} (Total: ${logsSol[cliente].total.toFixed(2)}, ${logsSol[cliente].time})
                    <button onclick="verifyLog('sol', '${cliente}')">✔️</button>
                    <button onclick="deleteLog('sol', '${cliente}')">❌</button>
                </li>`
            ).join('');
            document.getElementById('totalLogsSombraSol').innerText = (totalLogsSombra + totalLogsSol).toFixed(2);
            document.getElementById('totalLucro').innerText = totalLucro.toFixed(2);
            updatePacoteTotals();
            updateOuroCalculations();
            updateRegistrosDisplay();
        }

        function updateRegistrosDisplay() {
            document.getElementById('registrosCow').innerHTML = registrosCow.map(registro => 
                `<li class="log-item" id="log-cow-${registro.nome}">
                    ${registro.verified ? '✔️ ' : ''}${registro.nome}: ${registro.lista.join(', ')} (Total: ${registro.total}g, ${registro.time})
                    <button onclick="verifyRegistro('Cow', '${registro.nome}')">✔️</button>
                    <button onclick="deleteRegistro('Cow', '${registro.nome}')">❌</button>
                </li>`
            ).join('');
            document.getElementById('registrosLBW').innerHTML = registrosLBW.map(registro => 
                `<li class="log-item" id="log-lbw-${registro.nome}">
                    ${registro.verified ? '✔️ ' : ''}${registro.nome}: ${registro.lista.join(', ')} (Total: ${registro.total}g, ${registro.time})
                    <button onclick="verifyRegistro('LBW', '${registro.nome}')">✔️</button>
                    <button onclick="deleteRegistro('LBW', '${registro.nome}')">❌</button>
                </li>`
            ).join('');
            document.getElementById('registrosDW').innerHTML = registrosDW.map(registro => 
                `<li class="log-item" id="log-dw-${registro.nome}">
                    ${registro.verified ? '✔️ ' : ''}${registro.nome}: ${registro.lista.join(', ')} (Total: ${registro.total}g, ${registro.time})
                    <button onclick="verifyRegistro('DW', '${registro.nome}')">✔️</button>
                    <button onclick="deleteRegistro('DW', '${registro.nome}')">❌</button>
                </li>`
            ).join('');

            const totalCow = registrosCow.reduce((acc, registro) => acc + registro.total, 0);
            const totalLBW = registrosLBW.reduce((acc, registro) => acc + registro.total, 0);
            const totalDW = registrosDW.reduce((acc, registro) => acc + registro.total, 0);
            const totalClientes = totalCow + totalLBW + totalDW;

            document.getElementById('totalCow').innerText = totalCow;
            document.getElementById('totalLBW').innerText = totalLBW;
            document.getElementById('totalDW').innerText = totalDW;

            document.getElementById('totalClientes').innerText = totalClientes;

            document.getElementById('totalLucroCow').innerText = totalLucroCow.toFixed(2);
            document.getElementById('totalLucroLBW').innerText = totalLucroLBW.toFixed(2);
            document.getElementById('totalLucroDW').innerText = totalLucroDW.toFixed(2);

            const totalLucroGeral = totalLucroCow + totalLucroLBW + totalLucroDW;
            document.getElementById('totalLucroGeral').innerText = totalLucroGeral.toFixed(2);
        }

        function addToSombraLog(comissao, valor) {
            const nomeCliente = document.getElementById('nomeClienteSombra').value;
            if (nomeCliente) {
                if (!logsSombra[nomeCliente]) {
                    logsSombra[nomeCliente] = { values: [], total: 0, verified: false, comissao: 0, time: new Date().toLocaleString() };
                }
                logsSombra[nomeCliente].values.push(valor.toFixed(2));
                logsSombra[nomeCliente].total += valor;
                logsSombra[nomeCliente].comissao += comissao;
                totalComissaoSombra += comissao;
                totalLogsSombra += valor;
                updateDisplays();
                saveState();
            } else {
                alert("Por favor, insira o nome do cliente.");
            }
        }

        function addToSolLog(comissao, valor) {
            const nomeCliente = document.getElementById('nomeClienteSol').value;
            if (nomeCliente) {
                if (!logsSol[nomeCliente]) {
                    logsSol[nomeCliente] = { values: [], total: 0, verified: false, comissao: 0, time: new Date().toLocaleString() };
                }
                logsSol[nomeCliente].values.push(valor.toFixed(2));
                logsSol[nomeCliente].total += valor;
                logsSol[nomeCliente].comissao += comissao;
                totalComissaoSol += comissao;
                totalLogsSol += valor;
                updateDisplays();
                saveState();
            } else {
                alert("Por favor, insira o nome do cliente.");
            }
        }

        function resetSombra() {
            totalComissaoSombra = 0;
            totalLogsSombra = 0;
            logsSombra = {};
            updateDisplays();
            saveState();
        }

        function resetSol() {
            totalComissaoSol = 0;
            totalLogsSol = 0;
            logsSol = {};
            updateDisplays();
            saveState();
        }

        function verifyLog(panel, cliente) {
            if (panel === 'sombra') {
                logsSombra[cliente].verified = true;
            } else if (panel === 'sol') {
                logsSol[cliente].verified = true;
            }
            updateDisplays();
            saveState();
        }

        function deleteLog(panel, cliente) {
            if (panel === 'sombra') {
                totalLogsSombra -= logsSombra[cliente].total;
                totalComissaoSombra -= logsSombra[cliente].comissao;
                delete logsSombra[cliente];
            } else if (panel === 'sol') {
                totalLogsSol -= logsSol[cliente].total;
                totalComissaoSol -= logsSol[cliente].comissao;
                delete logsSol[cliente];
            }
            updateDisplays();
            saveState();
        }

        function updatePacoteQuantidades(pacote, quantidade) {
            pacoteQuantidades[pacote] = parseInt(quantidade) || 0;
            updatePacoteTotals();
            saveState();
        }

        function updatePacoteTotals() {
            let totalR = 0;
            let totalD = 0;
            Object.keys(pacoteQuantidades).forEach(pacote => {
                const subtotalR = pacoteQuantidades[pacote] * pacotePrecos[pacote] * exchangeRate;
                const subtotalD = pacoteQuantidades[pacote] * pacotePrecos[pacote];
                document.getElementById(`totalR${pacote}`).innerText = subtotalR.toFixed(2);
                document.getElementById(`totalD${pacote}`).innerText = subtotalD.toFixed(2);
                totalR += subtotalR;
                totalD += subtotalD;
            });
            document.getElementById('totalRPacotes').innerText = totalR.toFixed(2);
            document.getElementById('totalDPacotes').innerText = totalD.toFixed(2);
            saveState();
        }

        function updateExchangeRate(rate) {
            exchangeRate = parseFloat(rate) || 5.53;
            updatePacoteTotals();
        }

        function updateGoldRateR(rate) {
            goldRateR = parseFloat(rate) || 31.00;
            updateOuroCalculations();
        }

        function updateGoldRateD(rate) {
            goldRateD = parseFloat(rate) || 5.55;
            updateOuroCalculations();
        }

        function calcularLucro() {
            Object.keys(pacoteQuantidades).forEach(pacote => {
                totalLucro += pacoteQuantidades[pacote] * pacoteLucro[pacote];
            });
            resetPacoteQuantidades();
            updateDisplays();
            saveState();
        }
        function resetPacoteQuantidades() {
            Object.keys(pacoteQuantidades).forEach(pacote => {
                pacoteQuantidades[pacote] = 0;
                document.getElementById(`pacote${pacote}`).value = 0;
            });
            updatePacoteTotals();
            saveState();
        }

        function resetLucro() {
            totalLucro = 0;
            document.getElementById('totalLucro').innerText = '0.00';
            updateDisplays();
            saveState();
        }

        function updateOuroCalculations() {
            const quantidade = parseInt(document.getElementById('quantidadeOuro').value) || 0;
            const totalR = (quantidade / 1000) * goldRateR;
            const totalD = (quantidade / 1000) * goldRateD;
            listaOuroGlobal = calcularListaOuro(quantidade);

            document.getElementById('totalROuro').innerText = totalR.toFixed(2);
            document.getElementById('totalDOuro').innerText = totalD.toFixed(2);
            document.getElementById('quantidadeAnunciada').innerText = listaOuroGlobal.join(', ');
            saveState();
        }

        function calcularListaOuro(quantidade) {
            const quantidadeAnunciada = Math.floor(quantidade + (quantidade * 5.3 / 100));
            if (quantidade <= 2500) {
                return [quantidadeAnunciada];
            } else if (quantidade <= 5000) {
                return dividirEmPartes(quantidadeAnunciada, 2);
            } else if (quantidade <= 7500) {
                return dividirEmPartes(quantidadeAnunciada, 3);
            } else if (quantidade <= 10000) {
                return dividirEmPartes(quantidadeAnunciada, 4);
            } else {
                return [quantidadeAnunciada];
            }
        }

        function dividirEmPartes(total, partes) {
            const min = Math.floor(total / (partes + 1));
            const max = Math.ceil(total / partes);
            let resultado = [];
            let soma = 0;

            for (let i = 0; i < partes - 1; i++) {
                const valor = Math.floor(Math.random() * (max - min + 1)) + min;
                resultado.push(valor);
                soma += valor;
            }

            resultado.push(total - soma);
            return resultado;
        }

        function copiarTexto(texto) {
            navigator.clipboard.writeText(texto).then(() => {
                alert('Texto copiado: ' + texto);
            }, (err) => {
                alert('Erro ao copiar texto: ', err);
            });
        }

        function copiarPrecosAtualizados() {
            const exchangeRate = parseFloat(document.getElementById('exchangeRate').value) || 5.53;

            const precoR10 = (pacotePrecos[10] * exchangeRate).toFixed(2);
            const precoR30 = (pacotePrecos[30] * exchangeRate).toFixed(2);
            const precoR50 = (pacotePrecos[50] * exchangeRate).toFixed(2);
            const precoR100 = (pacotePrecos[100] * exchangeRate).toFixed(2);

            const texto = `𝗢𝘀 𝗽𝗿𝗲𝗰̧𝗼𝘀 𝗱𝗲 𝗽𝗮𝗰𝗼𝘁𝗲𝘀 𝗲 𝗽𝗮𝘀𝘀𝗲𝘀 𝘀𝗮̃𝗼:
•⭐𝐏𝐚𝐜𝐨𝐭𝐞𝐬 𝐝𝐞 $𝟏𝟎 = $${pacotePrecos[10]} 𝐨𝐮 𝗥$${precoR10}.⭐
•⭐𝐏𝐚𝐜𝐨𝐭𝐞𝐬 𝐝𝐞 $𝟑𝟎 = $${pacotePrecos[30]} 𝐨𝐮 𝗥$${precoR30}.⭐
•⭐𝐏𝐚𝐜𝐨𝐭𝐞𝐬 𝐝𝐞 $𝟓𝟎 = $${pacotePrecos[50]} 𝐨𝐮 𝗥$${precoR50}.⭐
•⭐𝐏𝐚𝐜𝐨𝐭𝐞𝐬 𝐝𝐞 $𝟏𝟎𝟎 = $${pacotePrecos[100]} 𝐨𝐮 𝗥$${precoR100}.⭐`;

            copiarTexto(texto);
        }

        function copiarMensagemPersonalizada() {
            const totalROuro = document.getElementById('totalROuro').innerText;
            const quantidadeAnunciada = document.getElementById('quantidadeAnunciada').innerText;
            const servidor = "Nome do Servidor";
            const texto = `Da um total de R$${totalROuro}.
Me fale o servidor e anuncie o item no mercado a ${quantidadeAnunciada}.`;

            copiarTexto(texto);
        }

        function registrarCliente(divisao) {
            const nomeCliente = document.getElementById(`nomeCliente${divisao}`).value;
            const lucro = parseFloat(document.getElementById(`lucro${divisao}`).value) || 0;

            if (nomeCliente && listaOuroGlobal.length > 0) {
                const total = listaOuroGlobal.reduce((acc, val) => acc + val, 0);
                const totalLucro = (total / 1053) * lucro;
                
                const registro = { nome: nomeCliente, lista: [...listaOuroGlobal], total, verified: false, lucro: totalLucro, time: new Date().toLocaleString() };
                
                switch (divisao) {
                    case 'Cow':
                        registrosCow.push(registro);
                        totalLucroCow += totalLucro;
                        break;
                    case 'LBW':
                        registrosLBW.push(registro);
                        totalLucroLBW += totalLucro;
                        break;
                    case 'DW':
                        registrosDW.push(registro);
                        totalLucroDW += totalLucro;
                        break;
                }
                updateRegistrosDisplay();
                saveState();
            } else {
                alert("Por favor, insira o nome do cliente e a quantidade de ouro.");
            }
        }

        function verifyRegistro(divisao, nomeCliente) {
            let registros;
            switch (divisao) {
                case 'Cow':
                    registros = registrosCow;
                    break;
                case 'LBW':
                    registros = registrosLBW;
                    break;
                case 'DW':
                    registros = registrosDW;
                    break;
            }
            const registro = registros.find(registro => registro.nome === nomeCliente);
            if (registro) {
                registro.verified = true;
                updateRegistrosDisplay();
                saveState();
            }
        }

        function deleteRegistro(divisao, nomeCliente) {
            let registros;
            switch (divisao) {
                case 'Cow':
                    registros = registrosCow;
                    const registroCow = registrosCow.find(registro => registro.nome === nomeCliente);
                    totalLucroCow -= registroCow.lucro;
                    registrosCow = registrosCow.filter(registro => registro.nome !== nomeCliente);
                    break;
                case 'LBW':
                    registros = registrosLBW;
                    const registroLBW = registrosLBW.find(registro => registro.nome === nomeCliente);
                    totalLucroLBW -= registroLBW.lucro;
                    registrosLBW = registrosLBW.filter(registro => registro.nome !== nomeCliente);
                    break;
                case 'DW':
                    registros = registrosDW;
                    const registroDW = registrosDW.find(registro => registro.nome === nomeCliente);
                    totalLucroDW -= registroDW.lucro;
                    registrosDW = registrosDW.filter(registro => registro.nome !== nomeCliente);
                    break;
            }
            updateRegistrosDisplay();
            saveState();
        }

        function resetRegistros(divisao) {
            switch (divisao) {
                case 'Cow':
                    registrosCow = [];
                    totalLucroCow = 0;
                    break;
                case 'LBW':
                    registrosLBW = [];
                    totalLucroLBW = 0;
                    break;
                case 'DW':
                    registrosDW = [];
                    totalLucroDW = 0;
                    break;
            }
            updateRegistrosDisplay();
            saveState();
        }

        window.onload = loadState;
    </script>
</body>
</html>
